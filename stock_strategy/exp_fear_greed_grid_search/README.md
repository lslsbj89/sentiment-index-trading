# Fear Greed Index 网格搜索实验

## 实验概述

**实验目的**: 基于 `fear_greed_index` 表的 `smoothed_index` 情绪指标，通过网格搜索找到各股票的最优交易参数。

**实验时间**: 2026-01-23

**回测期间**: 2021-01-01 ~ 2025-12-31 (5年)

---

## 交易策略

### 信号规则

```
买入条件: smoothed_index < buy_threshold
卖出条件: (smoothed_index > and_sell_threshold AND price < MA50)
          OR (smoothed_index > or_threshold)
```

### 策略逻辑

- **买入**: 当市场情绪极度恐惧时（指数低于阈值），逆向买入
- **卖出 (AND条件)**: 情绪转为贪婪 + 价格跌破MA50，确认趋势反转
- **卖出 (OR条件)**: 情绪极度贪婪时，无条件卖出（兜底机制）

### 回测参数

| 参数 | 值 |
|------|-----|
| 初始资金 | $100,000 |
| 仓位比例 | 80% |
| 手续费 | 0.1% |
| 滑点 | 0.1% |
| 止盈/止损 | 无 (完全依赖情绪信号) |

---

## 网格搜索参数

```python
BUY_THRESHOLDS = [-30, -25, -20, -15, -10, -5, 0, 5]
AND_SELL_THRESHOLDS = [5, 10, 15, 20, 25]
OR_THRESHOLDS = [25, 30, 35, 40, 45, 50, 55, 60, 65]

总组合数: 8 × 5 × 9 = 360 种参数组合
```

---

## 实验结果

### 全部股票汇总表

| 股票 | 买入阈值 | AND卖出 | OR卖出 | 总收益 | 年化收益 | 夏普比率 | 最大回撤 | 交易次数 | 胜率 |
|------|---------|---------|--------|--------|----------|----------|----------|----------|------|
| **NVDA** | 0 | 10 | 50 | 715.26% | 52.40% | **1.50** | -51.29% | 6 | 100% |
| **META** | -30 | 20 | 60 | 339.43% | 34.61% | **1.48** | -17.68% | 1 | 100% |
| **TSLA** | -15 | 25 | 45 | 511.03% | 43.83% | 1.13 | -53.65% | 4 | 75% |
| **AAPL** | -10 | 5 | 45 | 115.93% | 16.72% | 1.14 | -17.29% | 4 | 100% |
| **GOOGL** | 5 | 10 | 65 | 206.42% | 25.21% | 1.07 | -36.04% | 6 | 83% |
| **MSFT** | 0 | 10 | 25 | 123.56% | 17.53% | 0.92 | -26.30% | 5 | 80% |
| **AMZN** | -20 | 25 | 45 | 89.36% | 13.68% | 0.63 | -36.62% | 1 | 100% |
| **BABA** | -30 | 20 | 60 | 38.06% | 6.69% | 0.36 | -44.88% | 1 | 100% |

### 分层排名

**第一梯队 (夏普 > 1.0)** - 推荐使用:
| 股票 | 夏普比率 | 特点 |
|------|----------|------|
| NVDA | 1.50 | 高收益高波动，AI龙头 |
| META | 1.48 | 低回撤，2022年触底后强势反弹 |
| AAPL | 1.14 | 最稳健，回撤仅-17% |
| TSLA | 1.13 | 高绝对收益，但波动大 |
| GOOGL | 1.07 | 交易机会多，均衡表现 |

**第二梯队 (夏普 0.5-1.0)** - 可选使用:
| 股票 | 夏普比率 | 特点 |
|------|----------|------|
| MSFT | 0.92 | 接近第一梯队，稳定性好 |
| AMZN | 0.63 | 交易机会少，仅1笔 |

**第三梯队 (夏普 < 0.5)** - 不推荐:
| 股票 | 夏普比率 | 特点 |
|------|----------|------|
| BABA | 0.36 | 长期下跌趋势，策略难以盈利 |

---

## 关键发现

### 1. 参数规律

| 股票类型 | 买入阈值 | 说明 |
|----------|----------|------|
| 高成长股 (NVDA, MSFT, GOOGL) | 0 ~ 5 | 不需要等待极端恐惧 |
| 价值股 (AAPL, TSLA) | -10 ~ -15 | 需要适度恐惧 |
| 深度价值/困境股 (META, AMZN, BABA) | -20 ~ -30 | 需要极端恐惧才买入 |

### 2. OR卖出阈值

| 波动性 | OR阈值 | 代表股票 |
|--------|--------|----------|
| 高波动 | 50-65 | NVDA, META, GOOGL |
| 中波动 | 45 | TSLA, AAPL, AMZN |
| 低波动 | 25 | MSFT |

### 3. 策略适用性

- **最适合**: 有明显周期波动的科技成长股
- **较适合**: 稳定增长的大盘蓝筹股
- **不适合**: 长期处于下跌趋势的股票 (如 BABA)

### 4. 交易频率

- 5年期间交易次数 1-6 次不等
- 低频策略，适合长期投资者
- 情绪极端点出现频率有限

---

## 文件清单

### 脚本文件
- `fear_greed_grid_search.py` - 主网格搜索脚本 (含自动可视化)
- `visualize_trades.py` - 独立可视化脚本
- `show_trades.py` - 交易明细显示脚本

### 结果文件 (每只股票)
- `best_params_{SYMBOL}.txt` - 最优参数
- `grid_search_{SYMBOL}_{timestamp}.csv` - 完整搜索结果
- `trading_visualization_{SYMBOL}.png` - 交易可视化图

### 已测试股票
- [x] TSLA
- [x] AAPL
- [x] NVDA
- [x] MSFT
- [x] GOOGL
- [x] META
- [x] AMZN
- [x] BABA

---

## 可视化示例

每只股票生成 5 合 1 可视化图表:

1. **价格走势 + 买卖信号** - 绿色三角买入，红色三角卖出
2. **情绪指数** - 显示阈值线和恐惧/贪婪区间
3. **组合价值** - 资金曲线
4. **回撤曲线** - 标注最大回撤点
5. **滚动夏普比率** - 60日滚动计算

---

## 使用方法

### 运行单只股票搜索

```python
# 修改 fear_greed_grid_search.py 中的 SYMBOL
SYMBOL = "AAPL"  # 改为目标股票

# 运行
python3 fear_greed_grid_search.py
```

### 输出内容

1. 打印搜索进度和结果
2. 保存 CSV 完整结果
3. 保存最优参数 TXT
4. 自动生成可视化 PNG
5. 打印交易明细

---

## 后续优化方向

1. **样本外验证** - 使用 2016-2020 数据验证参数稳定性
2. **加入止损** - 测试固定止损对回撤的改善
3. **组合策略** - 多股票分散配置
4. **动态阈值** - 根据市场波动率调整阈值
5. **加入其他指标** - 结合技术指标过滤假信号

---

## 结论

Fear Greed Index 情绪策略在科技成长股上表现优异，尤其是 NVDA、META 等具有明显周期波动的股票。策略核心是**逆向投资**：在市场恐惧时买入，贪婪时卖出。

**推荐配置**:
- 优先选择夏普比率 > 1.0 的股票
- 注意回撤控制，AAPL 最稳健
- 避免在长期下跌趋势中使用该策略

---

*文档生成时间: 2026-01-23*
*实验框架: AAPL 量化交易回测系统 v6.0*
